# Blackwell / RTX 50xx (sm_120) compatible requirements
#
# Use this if you have an RTX 50xx GPU (e.g., RTX 5090) where the repo-pinned
# cu121 PyTorch wheels do not include sm_120 kernels.
#
# Recommended install:
#   conda activate gvhmr
#   pip install --no-build-isolation -r requirements_blackwell.txt
#
# Notes:
# - `pytorch3d` must be built from source for this torch/CUDA combo, so we pin it
#   to the upstream git repo. Build isolation must be disabled.
# - NVCC is required. Install into the env via:
#     conda install -y -c nvidia cuda-nvcc=12.8 cuda-cudart-dev=12.8
#

# PyTorch (CUDA 12.8 wheels; includes sm_120)
--extra-index-url https://download.pytorch.org/whl/cu128
torch==2.9.1+cu128
torchvision==0.24.1+cu128
timm==0.9.12  # For HMR2.0a feature extraction

# Lightning + Hydra
lightning==2.3.0
hydra-core==1.3
hydra-zen
hydra_colorlog
rich

# Common utilities
numpy==1.23.5
jupyter
matplotlib
ipdb
setuptools>=68.0
black
tensorboardX
opencv-python
ffmpeg-python
scikit-image
termcolor
einops
imageio==2.34.1
av==13.0.0  # imageio[pyav], improved performance over imageio[ffmpeg]
joblib

# Diffusion
# diffusers[torch]==0.19.3
# transformers==4.31.0

# 3D-Vision
# Built from source (requires NVCC; install with --no-build-isolation)
ninja
cmake
pytorch3d @ git+https://github.com/facebookresearch/pytorch3d.git
trimesh
chumpy
smplx
# open3d==0.17.0
wis3d
pycolmap

# 2D-Pose
ultralytics==8.2.42  # YOLO
cython_bbox
lapx
